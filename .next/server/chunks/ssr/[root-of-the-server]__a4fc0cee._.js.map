{"version":3,"sources":["turbopack:///[project]/node_modules/openid-client/package.json","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../lib/actions/auth.ts","../../../../.next-internal/server/app/auth/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["{\"name\":\"openid-client\",\"version\":\"5.7.1\",\"description\":\"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs\",\"keywords\":[\"auth\",\"authentication\",\"basic\",\"certified\",\"client\",\"connect\",\"dynamic\",\"electron\",\"hybrid\",\"identity\",\"implicit\",\"oauth\",\"oauth2\",\"oidc\",\"openid\",\"passport\",\"relying party\",\"strategy\"],\"homepage\":\"https://github.com/panva/openid-client\",\"repository\":\"panva/openid-client\",\"funding\":{\"url\":\"https://github.com/sponsors/panva\"},\"license\":\"MIT\",\"author\":\"Filip Skokan <panva.ip@gmail.com>\",\"exports\":{\"types\":\"./types/index.d.ts\",\"import\":\"./lib/index.mjs\",\"require\":\"./lib/index.js\"},\"main\":\"./lib/index.js\",\"types\":\"./types/index.d.ts\",\"files\":[\"lib\",\"types/index.d.ts\"],\"scripts\":{\"format\":\"npx prettier --loglevel silent --write ./lib ./test ./certification ./types\",\"test\":\"mocha test/**/*.test.js\"},\"dependencies\":{\"jose\":\"^4.15.9\",\"lru-cache\":\"^6.0.0\",\"object-hash\":\"^2.2.0\",\"oidc-token-hash\":\"^5.0.3\"},\"devDependencies\":{\"@types/node\":\"^16.18.106\",\"@types/passport\":\"^1.0.16\",\"base64url\":\"^3.0.1\",\"chai\":\"^4.5.0\",\"mocha\":\"^10.7.3\",\"nock\":\"^13.5.5\",\"prettier\":\"^2.8.8\",\"readable-mock-req\":\"^0.2.2\",\"sinon\":\"^9.2.4\",\"timekeeper\":\"^2.3.1\"},\"standard-version\":{\"scripts\":{\"postchangelog\":\"sed -i '' -e 's/### \\\\[/## [/g' CHANGELOG.md\"},\"types\":[{\"type\":\"feat\",\"section\":\"Features\"},{\"type\":\"fix\",\"section\":\"Fixes\"},{\"type\":\"chore\",\"hidden\":true},{\"type\":\"docs\",\"hidden\":true},{\"type\":\"style\",\"hidden\":true},{\"type\":\"refactor\",\"section\":\"Refactor\",\"hidden\":false},{\"type\":\"perf\",\"section\":\"Performance\",\"hidden\":false},{\"type\":\"test\",\"hidden\":true}]}}","/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","\"use server\"\n\nimport { signIn, signOut } from \"@/auth\"\nimport { prisma } from \"@/lib/prisma\"\nimport bcrypt from \"bcryptjs\"\nimport { AuthError } from \"next-auth\"\nimport crypto from \"crypto\"\n\nexport async function login(formData: FormData) {\n  const email = formData.get(\"email\") as string\n  const password = formData.get(\"password\") as string\n\n  try {\n    await signIn(\"credentials\", {\n      email,\n      password,\n      redirectTo: \"/dashboard\",\n    })\n  } catch (error) {\n    if (error instanceof AuthError) {\n      switch (error.type) {\n        case \"CredentialsSignin\":\n          return { error: \"Invalid email or password\" }\n        default:\n          return { error: \"Something went wrong\" }\n      }\n    }\n    throw error\n  }\n}\n\nexport async function signup(formData: FormData) {\n  const name = formData.get(\"name\") as string\n  const email = formData.get(\"email\") as string\n  const password = formData.get(\"password\") as string\n\n  try {\n    const existingUser = await prisma.user.findUnique({\n      where: { email },\n    })\n\n    if (existingUser) {\n      return { error: \"Email already in use\" }\n    }\n\n    const hashedPassword = await bcrypt.hash(password, 10)\n\n    await prisma.user.create({\n      data: {\n        name,\n        email,\n        password: hashedPassword,\n      },\n    })\n\n    await signIn(\"credentials\", {\n      email,\n      password,\n      redirectTo: \"/dashboard\",\n    })\n  } catch (error) {\n    if (error instanceof AuthError) {\n      return { error: \"Something went wrong during signup\" }\n    }\n    throw error\n  }\n}\n\nexport async function loginWithGoogle() {\n  await signIn(\"google\", { redirectTo: \"/dashboard\" })\n}\n\nexport async function logout() {\n  await signOut({ redirectTo: \"/\" })\n}\n\nexport async function requestPasswordReset(email: string) {\n  try {\n    const user = await prisma.user.findUnique({\n      where: { email },\n    })\n\n    if (!user) {\n      // Return success even if user not found to prevent email enumeration\n      return { success: true }\n    }\n\n    // Delete any existing tokens for this email\n    await prisma.passwordResetToken.deleteMany({\n      where: { email },\n    })\n\n    // Generate reset token\n    const token = crypto.randomBytes(32).toString(\"hex\")\n    const expires = new Date(Date.now() + 3600000) // 1 hour from now\n\n    await prisma.passwordResetToken.create({\n      data: {\n        email,\n        token,\n        expires,\n      },\n    })\n\n    // In production, you would send an email here\n    // For now, we'll just log the token\n    console.log(`Password reset token for ${email}: ${token}`)\n\n    return { success: true }\n  } catch (error) {\n    return { error: \"Failed to process password reset request\" }\n  }\n}\n\nexport async function resetPassword(token: string, newPassword: string) {\n  try {\n    const resetToken = await prisma.passwordResetToken.findUnique({\n      where: { token },\n    })\n\n    if (!resetToken) {\n      return { error: \"Invalid or expired reset token\" }\n    }\n\n    if (resetToken.expires < new Date()) {\n      await prisma.passwordResetToken.delete({\n        where: { id: resetToken.id },\n      })\n      return { error: \"Reset token has expired\" }\n    }\n\n    const hashedPassword = await bcrypt.hash(newPassword, 10)\n\n    await prisma.user.update({\n      where: { email: resetToken.email },\n      data: { password: hashedPassword },\n    })\n\n    await prisma.passwordResetToken.delete({\n      where: { id: resetToken.id },\n    })\n\n    return { success: true }\n  } catch (error) {\n    return { error: \"Failed to reset password\" }\n  }\n}\n","export {login as '4010913bf5452638d38e30ae76abaf1f94084c2c5e'} from 'ACTIONS_MODULE0'\nexport {loginWithGoogle as '006637cb3c0131ced68aa9cd118df31add723fdacf'} from 'ACTIONS_MODULE0'\nexport {signup as '40bd90e711c35bfb0929e035a03d7d1bed04913c32'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[1,2]}